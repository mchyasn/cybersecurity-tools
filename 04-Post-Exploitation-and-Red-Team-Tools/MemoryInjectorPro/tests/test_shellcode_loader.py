import unittest
import modules.shellcode_loader as shellcode_loader

class TestShellcodeLoader(unittest.TestCase):
    def test_loader_function_exists(self):
        self.assertTrue(callable(shellcode_loader.load_and_execute_shellcode))

    def test_loader_dry_run(self):
        try:
            fake_shellcode = b"\x90" * 32  # 32-byte NOP sled
            buffer = shellcode_loader.ctypes.create_string_buffer(fake_shellcode)
            self.assertEqual(len(buffer), 33)  # Includes null terminator
        except Exception as e:
            self.fail(f"Shellcode preparation failed: {e}")
