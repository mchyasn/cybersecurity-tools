# CredHarvesterX

CredHarvesterX is an advanced credential dumper and session hijacker inspired by Mimikatz, LaZagne, and Rubeus. It is designed to extract sensitive authentication artifacts from Windows systems, including credentials, tokens, cookies, and browser passwords.

---

## Features

* Extracts credentials from LSASS memory using `procdump.exe`
* Dumps Chrome cookies and optionally decrypts saved passwords via DPAPI
* Enumerates and impersonates user tokens (via `pywin32`)
* Recovers SSH private keys from `.ssh/` directories
* Sends all output to local files or optionally to remote C2/LogSentinel
* Supports both Windows and Linux (non-Windows modules auto-skip)

---

## Folder Structure

```
CredHarvesterX/
├── main.py                      # CLI orchestrator
├── lsass_dump.py               # Dumps LSASS using procdump
├── chrome_creds.py             # Chrome cookie + password extraction
├── token_hijack.py             # Token enumeration + impersonation
├── ssh_key_grabber.py          # Collects private SSH keys
├── dpapi_decrypt.py            # Stub for DPAPI decryption
├── c2_output.py                # Sends results to remote C2
├── utils.py                    # Helpers: admin check, platform detection
├── requirements.txt            # Python dependencies
├── README.md                   # Documentation
│
├── bin/
│   └── procdump.exe            # Required for LSASS dump (place here manually)
├── output/
│   ├── creds.txt
│   ├── tokens.txt
│   └── chrome_dump.json
├── tests/
│   ├── test_lsass_dump.py
│   ├── test_chrome_creds.py
│   ├── test_token_hijack.py
│   └── test_dpapi_decrypt.py
├── screenshots/                # Test result screenshots
```

---

## Usage

### 1. Set up virtual environment

```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 2. Place `procdump.exe` (Windows only)

Download from Microsoft Sysinternals and place in:

```
bin/procdump.exe
```

### 3. Run tool

```bash
python3 main.py --verbose
```

Optional flags:

* `--no-c2` to disable output to remote servers
* `--verbose` to print debug info

### 4. Output files

All results are stored in the `output/` directory.

### 5. Send output to C2 (optional)

Set LogSentinel or C2 URL via environment variable:

```bash
export LOGSENTINEL_URL="https://logs.example.com/collect"
```

---

## Run Tests

```bash
python3 -m unittest discover tests
```

---

## Author

Created by **mchyasn**

---

## License

MIT License
