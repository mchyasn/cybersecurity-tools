import argparse
from modules import detector, installer, remover

def main():
    parser = argparse.ArgumentParser(description="AutoPersistenceKit - Cross-platform persistence installer")
    parser.add_argument("--mode", choices=["install", "remove"], required=True, help="Mode: install or remove persistence")
    parser.add_argument("--verbose", action="store_true", help="Enable verbose output")
    args = parser.parse_args()

    platform = detector.detect_platform()
    if args.verbose:
        print(f"[+] Detected platform: {platform}")

    if args.mode == "install":
        installer.install_persistence(platform, verbose=args.verbose)
    elif args.mode == "remove":
        remover.remove_persistence(platform, verbose=args.verbose)

if __name__ == "__main__":
    main()
