import unittest
from stego_c2 import embed_command_in_image, extract_command_from_image
import os

class TestStegoC2(unittest.TestCase):
    def test_embed_and_extract(self):
        command = "echo hello"
        input_path = "test_vectors/sample_carrier.png"
        output_path = "test_vectors/encoded_command.png"

        # Create a dummy image for testing
        from PIL import Image
        Image.new("RGB", (300, 300), color=(255, 255, 255)).save(input_path)

        embed_command_in_image(command, input_path, output_path)
        extracted = extract_command_from_image(output_path)

        self.assertEqual(extracted, command)

if __name__ == "__main__":
    unittest.main()
