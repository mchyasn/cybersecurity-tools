# TokenThief

TokenThief is a cloud session and token extractor designed to identify and reuse cloud credentials from AWS, GCP, and Azure developer environments. It supports session impersonation and optional IAM privilege escalation simulation.

---

## Features

* Extracts local cloud credentials from:

  * AWS CLI config, environment vars
  * GCP gcloud legacy credentials
  * Azure CLI accessTokens.json
* Centralized token aggregator
* Session impersonation modules (replay stub)
* IAM escalation simulation (placeholders)
* Clean modular layout for automation and red teaming

---

## Folder Structure

```
TokenThief/
├── main.py                      # CLI launcher
├── requirements.txt
├── config.py                    # Constants and file paths
├── modules/
│   ├── aws_enum.py             # AWS token extractor
│   ├── gcp_enum.py             # GCP token extractor
│   ├── azure_enum.py           # Azure token extractor
│   ├── token_extractor.py     # Central aggregator
│   ├── iam_abuse.py           # IAM privilege escalation stubs
│   └── session_replay.py      # Session replay stubs
├── tests/
│   ├── test_aws.py
│   ├── test_gcp.py
│   ├── test_azure.py
│   ├── test_iam_abuse.py
│   ├── test_token_extractor.py
├── output/
│   ├── aws_tokens.txt
│   ├── gcp_tokens.txt
│   └── azure_tokens.txt
├── screenshots/
```

---

## Setup

```bash
cd TokenThief
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

If build fails on Linux:

```bash
sudo apt install python3-dev build-essential libffi-dev libssl-dev
```

---

## Usage

### AWS token extraction

```bash
python3 main.py --mode extract --provider aws --verbose
```

### GCP token extraction

```bash
python3 main.py --mode extract --provider gcp --verbose
```

### Azure token extraction

```bash
python3 main.py --mode extract --provider azure --verbose
```

### Extract all providers

```bash
python3 main.py --mode extract --provider all --verbose
```

### Simulate session replay

```bash
python3 main.py --mode replay --provider aws
python3 main.py --mode replay --provider gcp
python3 main.py --mode replay --provider azure
```

### IAM abuse simulation

```bash
python3 main.py --mode escalate --provider aws
```

---

## Testing

```bash
python3 -m unittest discover tests
```
![Token Impersonation Toolkit](https://raw.githubusercontent.com/mchyasn/cybersecurity-tools/main/04-Post-Exploitation-and-Red-Team-Tools/TokenThief/screenshots/0.png)

All tests are environment-safe and will skip gracefully if credentials are missing.

---

## Author

Created by **mchyasn**

---

## License

MIT License
