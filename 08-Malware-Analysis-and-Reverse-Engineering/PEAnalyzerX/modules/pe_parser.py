import pefile

def parse_pe(file_path):
    try:
        pe = pefile.PE(file_path)
        return {
            "entry_point": hex(pe.OPTIONAL_HEADER.AddressOfEntryPoint),
            "image_base": hex(pe.OPTIONAL_HEADER.ImageBase),
            "sections": [(s.Name.decode().strip("\x00"), hex(s.VirtualAddress), s.Misc_VirtualSize) for s in pe.sections],
            "imports": [entry.dll.decode() for entry in pe.DIRECTORY_ENTRY_IMPORT] if hasattr(pe, "DIRECTORY_ENTRY_IMPORT") else []
        }
    except Exception as e:
        return {"error": str(e)}
