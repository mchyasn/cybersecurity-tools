# PEAnalyzerX

**PEAnalyzerX** is a static analysis tool for Windows Portable Executable (PE) files. It extracts structural metadata, calculates entropy, performs YARA rule scanning, checks VirusTotal (optional), and flags suspicious indicators such as packers or obfuscation.

---

## Features

* Parses PE headers, imports, entry point, image base
* Extracts section names, sizes, and virtual addresses
* Calculates overall entropy to detect packing
* Scans with custom YARA rules
* Optionally submits to VirusTotal (API key required)
* Flags anomalies like:

  * High entropy
  * Suspicious section names
  * PE parsing failures

---

## Folder Structure

```
PEAnalyzerX/
├── config/
│   └── config.yml
├── logs/
│   └── analysis.log
├── modules/
│   ├── pe_parser.py
│   ├── entropy_calc.py
│   ├── yara_scanner.py
│   ├── vt_checker.py
│   └── indicators.py
├── output/
│   └── report.csv
├── rules/
│   └── suspicious.yar
├── samples/
├── screenshots/
├── main.py
└── requirements.txt
```

---

## Installation

```bash
cd PEAnalyzerX
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

---

## Configuration

Edit your VirusTotal API key in `config/config.yml`:

```yaml
vt_api_key: "PASTE_YOUR_API_KEY_HERE"
entropy_threshold: 7.5
```

If you leave `vt_api_key` unset, VT scanning is skipped.

---

## Usage

1. Drop one or more `.exe` files into the `samples/` directory.

2. Run the tool:

```bash
python3 main.py
```

3. Results will be saved to:

* `output/report.csv`
* `logs/analysis.log`

---

## Output Example

```csv
file,entry_point,imports,entropy,yara_matches,vt,flags
test.exe,0x401000,["KERNEL32.dll"],{"overall": 6.89},["SuspiciousHexString"],Submitted...,['High entropy']
```

---

## YARA Rule Example

```yara
rule SuspiciousHexString {
    strings:
        $hex_string = { 2e 78 79 7a }
    condition:
        $hex_string
}
```

---

## Author

Created by [mchyasn](https://github.com/mchyasn)

---

## License

This project is for educational and research purposes only.
