import argparse
from modules.monitor import start_monitoring
from modules.runner import run_sample
from modules.timeline import generate_report

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="MalXray - Lightweight Dynamic Malware Analysis Sandbox")
    parser.add_argument("-s", "--sample", required=True, help="Path to suspicious binary")
    parser.add_argument("-c", "--config", default="configs/config.yaml", help="Path to config file")
    args = parser.parse_args()

    print("[+] Starting behavior monitor...")
    log_file = start_monitoring()

    print(f"[+] Executing sample: {args.sample}")
    run_sample(args.sample)

    print("[+] Generating timeline report...")
    generate_report(log_file)
