import capstone, os

def load_binary(path):
    with open(path, "rb") as f:
        binary = f.read()

    md = capstone.Cs(capstone.CS_ARCH_X86, capstone.CS_MODE_32)
    md.detail = True

    instructions = []
    for i in md.disasm(binary, 0x1000):
        instructions.append({
            "offset": i.address,
            "mnemonic": i.mnemonic,
            "op_str": i.op_str
        })
    return instructions
