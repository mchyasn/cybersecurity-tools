from capstone import Cs, CS_ARCH_X86, CS_MODE_32, CS_MODE_64

def disassemble_shellcode(code, arch):
    mode = CS_MODE_32 if arch == "x86" else CS_MODE_64
    cs = Cs(CS_ARCH_X86, mode)
    cs.detail = True
    for ins in cs.disasm(code, 0x1000):
        print(f"0x{ins.address:x}:\t{ins.mnemonic}\t{ins.op_str}")
