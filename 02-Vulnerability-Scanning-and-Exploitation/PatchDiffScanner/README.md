# PatchDiffScanner – Differential Patch Vulnerability Analyzer

## Description

PatchDiffScanner analyzes binary differences between patched and unpatched versions of software to identify potential vulnerability points. It performs function-level and instruction-level diffing, highlights added, removed, or modified code, and supports optional CVE tagging via changelog analysis.

This tool is designed for reverse engineers, vulnerability researchers, and exploit developers.

## Use Case

After a vendor releases a patch, use this tool to:

* Compare binaries before and after the patch.
* Identify modified or added functions.
* Detect inserted validations or removed vulnerable logic.
* Infer the root cause of CVEs for exploit development or 0-day hunting.

## Features

* Binary diffing for ELF, PE (.exe, .dll), and SO files
* Function-level symbol comparison using LIEF
* Instruction-level diffing using Radare2 (mnemonic comparison)
* CVE tag extraction from changelog or release notes
* Output in JSON format
* Includes a test suite using pytest

## Installation

1. Clone the repository:

   ```bash
   git clone <your-repo-url>
   cd PatchDiffScanner
   ```

2. Create a virtual environment using Python 3.10 (required for LIEF compatibility):

   ```bash
   python3.10 -m venv venv
   source venv/bin/activate
   ```

3. Install dependencies:

   ```bash
   pip install -r requirements.txt
   ```

## Usage

1. Place the binaries to compare in the appropriate folders:

   ```
   binaries/unpatched/target.bin
   binaries/patched/target.bin
   ```

2. (Optional) Place a changelog file in the root directory as `changelog.txt`.

3. Run the tool:

   ```bash
   python main.py
   ```

4. Results will be saved in the `output/` directory:

   * `diff_report.json` — function-level differences
   * `deep_diff.json` — instruction-level mnemonic differences (via Radare2)

## Configuration

Edit `config.json` to control behavior:

```json
{
  "diff_mode": "function",
  "disassembler": "radare2",
  "output_format": "json",
  "output_dir": "output"
}
```

## Testing

Run the provided test suite:

```bash
python -m pytest test_patchdiffscanner.py
```

Ensure your virtual environment is activated and Python version is 3.10.

## Notes

* Radare2 must be installed and accessible via `r2` in PATH.
* LIEF does not support Python versions above 3.10 as of this release.
* If binaries are invalid or not supported, meaningful errors will be shown.

## License

This project is released under the MIT License.
