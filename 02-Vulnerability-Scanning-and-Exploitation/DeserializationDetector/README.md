# DeserializationDetector

**DeserializationDetector** is a multi-platform scanner that detects insecure deserialization vulnerabilities in **Java**, **PHP**, and **.NET** applications. It simulates known deserialization gadget payloads and observes response behavior for signs of exploitability.

> Ideal for red teamers, web app pentesters, and exploit developers.

---

## Supported Stacks

* **Java**: Checks for Commons-Collections style deserialization triggers
* **PHP**: Simulates vulnerable `unserialize()` payloads
* **.NET**: Sends BinaryFormatter-style probes to look for .NET deserialization bugs

---

## Installation

```bash
cd DeserializationDetector
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

---

## Usage

```bash
python3 main.py <stack> <url> [--output <file>] [--verbose]
```

### Required Arguments

* `stack`: One of `java`, `php`, `dotnet`
* `url`: Target endpoint to test (e.g., [http://host/api](http://host/api))

### Optional Flags

* `--output`: Custom output filename (default: scans/<stack>\_<url>.txt)
* `--verbose`: Enable console debug logging

### Examples

```bash
python3 main.py java http://httpbin.org/post
python3 main.py php http://httpbin.org/post
python3 main.py dotnet http://httpbin.org/post
```

---

## Output & Logging

* Results saved to `scans/`
* Debug logs stored in `logs/debug.log`
* Colored CLI output (via colorama)

---

## File Structure

```
DeserializationDetector/
├── main.py
├── requirements.txt
├── utils.py
├── logs/
│   └── debug.log
├── scans/
│   └── *.txt
├── screenshots/
├── modules/
│   ├── java_detector.py
│   ├── php_detector.py
│   └── dotnet_detector.py
└── README.md
```

---

## Screenshots

| Filename                | Description                          |
| ----------------------- | ------------------------------------ |
| `java_cli_result.png`   | Terminal output of Java scan         |
| `java_output_file.png`  | Contents of Java scan result file    |
| `php_cli_result.png`    | Terminal output of PHP scan          |
| `dotnet_cli_result.png` | Terminal output of .NET scan         |
| `error_debug.png`       | Screenshot of error/timeout behavior |

---

## Author

Created by **mchyasn** as part of the Cybersecurity Tool Series.

---

## Disclaimer

Use only on systems and endpoints you have explicit permission to test. Payloads are simulated and not fully weaponized.

---

## References

* Java Gadgets: [https://github.com/frohoff/ysoserial](https://github.com/frohoff/ysoserial)
* PHP Deserialization: [https://owasp.org/www-community/vulnerabilities/PHP\_Object\_Injection](https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection)
* .NET BinaryFormatter: [https://github.com/pwntester/ysoserial.net](https://github.com/pwntester/ysoserial.net)
