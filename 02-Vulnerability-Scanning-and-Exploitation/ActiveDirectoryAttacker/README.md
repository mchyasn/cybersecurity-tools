# ActiveDirectoryAttacker

**ActiveDirectoryAttacker** is a professional-grade internal assessment tool designed to demonstrate common Active Directory (AD) exploitation techniques. It supports LDAP enumeration and NTLM abuse, showcasing real-world lateral movement and information gathering strategies within Windows environments.

> Intended for internal red teams, blue team defenders, and Active Directory auditors.

---

## Supported Techniques

* **LDAP Enumeration** *(Windows Server only)*

  * Dynamic base DN discovery
  * Queries for users and groups
  * Clean formatting and error handling
* **NTLM Probing** *(Tested on Windows 11)*

  * SMB login attempts with status output
  * Dialect check and share enumeration
  * Handles failures gracefully

---

## Installation

```bash
cd ActiveDirectoryAttacker
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

---

## Usage

```bash
python3 main.py <method> <target> [options]
```

### Methods:

* `ldap` – Perform LDAP-based enumeration *(requires Domain Controller)*
* `ntlm` – Perform NTLM authentication and share probing

### Common Options:

* `--domain <DOMAIN>` – Target domain or WORKGROUP
* `--username <USER>` – Username (for NTLM only)
* `--password <PASS>` – Password (for NTLM only)
* `--auth simple|kerberos` – Auth mode (kerberos not yet implemented)
* `--output <file>` – Output filename (default: scans/<method>\_<target>.txt)
* `--verbose` – Show debug logs in terminal
* `--version` – Show tool version

### Examples:

```bash
# NTLM probe (tested)
python3 main.py ntlm 192.168.44.130 --domain WORKGROUP --username Admin --password test123

# LDAP (requires domain controller)
python3 main.py ldap 192.168.1.5 --domain corp.local --auth simple
```

---

## File Structure

```
ActiveDirectoryAttacker/
├── main.py
├── utils.py
├── requirements.txt
├── logs/
│   └── debug.log
├── scans/
│   └── *.txt
├── modules/
│   ├── ldap_enum.py
│   └── ntlm_probe.py
├── screenshots/
└── README.md
```

---

## Screenshots

![Active Directory Attack Simulator](https://raw.githubusercontent.com/mchyasn/cybersecurity-tools/main/02-Vulnerability-Scanning-and-Exploitation/ActiveDirectoryAttacker/screenshots/0.png)

---

## Author

Developed by **mchyasn** as part of the Cybersecurity Tools series.

---

## Disclaimer

This tool is for educational and authorized internal security assessments only. Do not use on networks you do not own or control.

---

## References

* Impacket: [https://github.com/SecureAuthCorp/impacket](https://github.com/SecureAuthCorp/impacket)
* ldap3 Docs: [https://ldap3.readthedocs.io/en/latest/](https://ldap3.readthedocs.io/en/latest/)
* NTLM Protocol: [https://docs.microsoft.com/en-us/openspecs/windows\_protocols/ms-nlmp/](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nlmp/)
