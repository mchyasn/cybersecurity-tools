import argparse
from smbghost_check import SMBGhostScanner
from utils import validate_ip

def main():
    parser = argparse.ArgumentParser(description="SMBGhostCheck â€“ CVE-2020-0796 Passive Vulnerability Scanner")
    parser.add_argument("target", help="Target IP address to scan")
    args = parser.parse_args()

    if not validate_ip(args.target):
        print("[!] Invalid IP address.")
        return

    scanner = SMBGhostScanner(args.target)
    result = scanner.run()

    if result is True:
        print(f"[+] {args.target} is likely VULNERABLE to SMBGhost (CVE-2020-0796)")
    elif result is False:
        print(f"[-] {args.target} is NOT vulnerable to SMBGhost.")
    else:
        print(f"[!] Could not determine vulnerability status for {args.target}")

if __name__ == "__main__":
    main()
