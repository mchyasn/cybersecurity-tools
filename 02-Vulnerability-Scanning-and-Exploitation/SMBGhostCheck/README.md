# SMBGhostCheck

**SMBGhostCheck** is a passive vulnerability scanner for **CVE-2020-0796 (SMBGhost)**. It detects whether a target Windows machine is likely vulnerable to the SMBv3 compression bug (SMBv3.1.1) **without crashing or triggering the vulnerability**.

> This tool is intended for security professionals, red teamers, and blue teamers performing internal network audits.

---

## Vulnerability Overview

* **CVE-ID**: CVE-2020-0796
* **Name**: SMBGhost
* **Affected**: Windows 10 versions 1903, 1909 (unpatched)
* **Protocol**: SMBv3.1.1 with compression enabled
* **Risk**: RCE (Remote Code Execution)

---

## Features

* Passive scan (no exploit, no crash)
* Checks SMB dialect version
* Uses Impacket for reliable SMB handling
* Logs vulnerable, safe, or indeterminate results

---

## Folder Structure

```
SMBGhostCheck/
├── main.py                  # Entry point
├── smbghost_check.py       # Vulnerability check logic
├── utils.py                # IP validation
├── requirements.txt        # Dependencies
├── screenshots/            # Output screenshots (user-generated)
```

---

## Installation

```bash
# Clone and enter the folder
cd SMBGhostCheck

# Create virtual environment
python3 -m venv venv
source venv/bin/activate

# Install dependencies
pip install -r requirements.txt
```

---

## Usage

```bash
sudo python3 main.py <target_ip>
```

### Example:

```bash
sudo python3 main.py 192.168.44.130
```

### Possible Outputs:

* \[+] 192.168.x.x is likely VULNERABLE to SMBGhost (CVE-2020-0796)
* \[-] 192.168.x.x is NOT vulnerable to SMBGhost.
* \[!] Could not determine vulnerability status for 192.168.x.x

---

## Testing Scenarios

| Scenario                      | Expected Result                             |
| ----------------------------- | ------------------------------------------- |
| SMBv3.1.1 (unpatched)         | likely VULNERABLE                           |
| SMBv2/3 (patched)             | NOT vulnerable                              |
| SMB enabled but access denied | Could not determine vulnerability status    |
| Port 445 closed / no response | Connection timed out -> Could not determine |

---

## Screenshots

| Filename                   | Description                               |
| -------------------------- | ----------------------------------------- |
| not\_vulnerable\_win11.png | Scan result for safe Windows 11 machine   |
| access\_denied\_win11.png  | Access denied, SMB present but restricted |
| connection\_refused.png    | Target offline or SMB disabled            |

Store all in the `screenshots/` folder.

---

## Author

Developed by **mchyasn** as part of the Cybersecurity Tool Series.

---

## Disclaimer

This tool is for **educational and authorized security testing only**. Do **not** use against systems you do not own or have explicit permission to test.

---

## References

* Microsoft CVE-2020-0796 Advisory: [https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0796](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0796)
* ZecOps SMBGhost Analysis: [https://blog.zecops.com/research/smbghost-critical-vulnerability-deep-dive-cve-2020-0796/](https://blog.zecops.com/research/smbghost-critical-vulnerability-deep-dive-cve-2020-0796/)
* Impacket GitHub: [https://github.com/SecureAuthCorp/impacket](https://github.com/SecureAuthCorp/impacket)
