import argparse
from modules.upnp_scanner import scan_upnp
from modules.mqtt_scanner import scan_mqtt
from modules.telnet_scanner import scan_telnet

def main():
    parser = argparse.ArgumentParser(description="IoTExploitHunter â€“ Embedded Protocol Scanner (UPnP, MQTT, Telnet)")
    parser.add_argument("protocol", choices=["upnp", "mqtt", "telnet"], help="Target protocol to scan")
    parser.add_argument("target", help="Target IP address or broker hostname")
    parser.add_argument("--port", type=int, help="Custom port (optional)")
    args = parser.parse_args()

    if args.protocol == "upnp":
        scan_upnp()
    elif args.protocol == "mqtt":
        scan_mqtt(args.target, args.port or 1883)
    elif args.protocol == "telnet":
        scan_telnet(args.target, args.port or 23)

if __name__ == "__main__":
    main()
