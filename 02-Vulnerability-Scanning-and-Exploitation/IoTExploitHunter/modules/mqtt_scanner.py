import paho.mqtt.client as mqtt

def on_connect(client, userdata, flags, rc):
    if rc == 0:
        print("[+] MQTT Broker allows unauthenticated connection.")
    else:
        print("[-] Connection refused or requires authentication.")

def scan_mqtt(target, port):
    print(f"[*] Connecting to MQTT broker at {target}:{port}...")
    client = mqtt.Client()
    client.on_connect = on_connect
    try:
        client.connect(target, port, 3)
        client.loop_start()
    except Exception as e:
        print(f"[!] Error connecting to MQTT broker: {e}")
